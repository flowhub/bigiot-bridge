name: "Parking data transformation"
topic: "flowhub-bigiot-bridge/NormalizeParkingData"
fixture:
 type: 'fbp'
 data: |
  INPORT=read.IN:filename
  OUTPORT=validate.ERRORS:validationerrors
  OUTPORT=errors.OUT:error

  read(filesystem/ReadFile) -> parse(strings/ParseJson)
  'bigiot/ParkingSpaceOffering' -> schema(LoadSchema) -> SCHEMA validate(ValidateData)
  
  parse -> testee(NormalizeParkingData) -> validate

  read ERROR -> errors(core/Repeat)  
  parse ERROR -> errors
  schema ERROR -> errors
cases:
-
  name: 'with known-good API data'
  assertion: 'output should be valid'
  inputs:
    filename: 'spec/data/bahnpark/occupancies-13.23-26.09.2017.json'
  expect:
    validationerrors:
      equals: []
