language: node_js
node_js:
- '8'
dist: trusty
services:
- docker
- redis
before_script:
- cp .env-default .env
- npm run build
- npm run tag
- npm run registry-login
after_success:
- test -n "$TRAVIS_TAG" && npm run deploy
env:
  matrix:
  - NOFLO_FATAL_DEPRECATED=true REDIS_URL=redis://localhost:6379
  global:
  - secure: n6wG54s2+59nkNfD1hBZMoH7qPSyceqCibABfHoANlpNCA0rMVr26oB0RqOHk7R86MHPkCgyoCfgz65pCWKOTakiBXZjoJNov8ij5WPqwBckBtnsDxKGscGuIZ3REwrZHGqxXOYLnkaD72F6OFN0S6AgjVONpqTyZSsIKY1cJdP7d9e4u5xB48edyNE6APF9l3Hl3Gnj07Na3ksdyq5XdxvBOHKK9UDDEsKN5rmWs+eIvUjNIeRK1MAIy87YUvcA1G7HpOAibf7zDtIwO8Pj0QKVnqVEOa0vFWkNOxdltuJzRBpduVJgpMlrH3xKyXBd+C1kJdHMhvAZFm3y6Q3YIkRHtw9M+3sFU5VJlQixufNHuoXau0kBRtRpENlxNJBSLt7QT0jAjXqmEnqpmF2r3PEInp6pfVfwBUHPP2DwIMrgJHKpWEpLpYC7zAD+FmDreZGhQPjDhE7FQGAO5n/0OdpdOS3q72/oxEXNFyOWf75KEm0P/CQ9+Bf0tdB6HHnhg+G2oyvKXc8tFTmImWoNFofTiU7KIlQ+1NQQX//ZB2h0ajAwDt2rpbvpc2mXuzUcHn0WrCMTimJeg8elkNmqdFWd+f0wnXsGptmS30PpCs9xhfp3NqMtkMsDSs/1qQAL1L9cWu7Zosle7/9vts79vgf0TG5uV3AWsImP1gduHLU=
  - secure: Q9b8Zvkyniq34QOZ8k7JRLg5+nL+yOSDvn4/TBoiqXHjGQ56baFV0BAJ9ioiDAAVd8/B65q4IsGsZJ8G91OgehAGDbuzYGi88zpJgREaCYksS9NFUsM0nC9Ukilqqmug0otI36SuxKHOM/lYIAF3hAIt1Y6poYKWDR/II8A2BNXytEya26sZvNT7hzkzUPA3sUaXYmNxZjuUlOKZF/Pg2Cffwa5CTkm/0gzuQh6YtncvIQxWfjgDJe7XxCHqlKonc+I6Lm3WJTvnoZaJLW0uL/2zpdG4FnhdyzOrniCIc4oZIQZ+H7RoPgVE5XNH+mYiuDMMuP2JLouYVdHjxyjYvBWSxDsDNDgKTx717Y64yPgl6TfvMAfT3hvYQ07qu7m7zhfAblFr/UIl1V3oMyERI8vG1FPOIj9SWUgQBqX9r55FDfiZu9sr8KaU35rIPPhqaJXJmwEAN5nO94TH62sV3sNTnX8sJS4IbOyJ9JyxdZyBHJB236gP9BlPyhb6dPW+4Ar0FivmTC4R2cExrlHDVeI8AEKJUUpClAXxjuH2oJ9VaN0iZStT7HVrSrxrUZab5ACJNP7xW4R3RXY8SujsychEeirkXGWwPNSuo8c8DizZP+um6KH5Xeg/PAZ1qk2DlUtR8UMGSfro2cVwrV2jEljYsH7a0VqwJ0mmaCgTYhE=
  - secure: oNz8nGmxBCvPfc3otCxbnT742Z7BrLnz5aLYVllwTw1vWxSacp0AftXzcsX/OKzjReyqJ0AZEn0OF1BGV8UrL3RbW8tBC6erOFsQkouNX+2K+2glM7fI5NurXwneWs2HaZETgR9igjJ1/F3FnbIa3o/w0NGX+WT6BizVCmfdQegx2Vh+4n+sFrnaJhjPWfp7+YyxnmXyS2rLaA6+IA0ZTvC6MwwhqxdVahkDz6FL/8KdV0JETNTCCs+2foY/nt2C+0wJDTTNjxGBdBYd4rBr3Y30/Jg0f0v8C3izNjsbUutlS5mHhf9exLxhkz5caBkvfRWbFQExOdwe5Rp+HS9XHgB1SS7tamVNRv5CCUZI4fTHFVcA9aiPxwhJkLnmezSlEkYBavWCl9WzD6hYSnt+9Zt68wRhhKNpZQMxdTsz25kYp4zeE6RN7+rzmZL5aZWRiwxrWQk+JvBUzSeuz8f/wRjvIdpz53Orgry4Qrhxi6GgBcfXTtXJJHprlU9FFEwhiMOjoKGnB+mWd3anMv2dCPltIpJcWVQH1gG1DRknT/ElSRrK9g1527JSI+e6sozOz7fBi15VzMWe+aixXXmdrb4A2elzEo6HMIGWpLLN1JpLY6d4fH7+SzPlvXugpiXyccrOVfr22pWT1V+hzyI9QxBGZJ3nnoOYIooqeNdCjTI=
  - secure: cUj0rJFE1FYsGN6R9kHxt9WbQdwAGhz/arBhHk8Q8CxxJZ6KU0pxHBSefcLHZSkrKR/12qfodlWd3IS/EgwwKWGcx67bgXhrVSN9joQc9dJgMFeryhbd2exUmerwA2hfUUa9kM6GzRVi5lcKWVJOs0VgdwPSLUENqpEhFEO4UfCM5q/2e3Bye3dKdQB1sa5Tf23UjRe41AKXnZZ9UNI4Tslqd38z6F/gosqXZcaMhey3gwGjDE6ODrf2fo0Vz/pFCYP0HPtP3HTklJ67xWfFdQjWsBC/epFgEU5a5EP9FskGyOzUXRGvcmBbBVfLbRACIjQXOpew0tpQ3+US6sExBgFVgljMo0z9UOjj7wn7S5IKMkm/vZiZmSfnuQwdYvzCKLUkTj3SMn+ZcnJwihSe8FOeb7SnVEgX7x1M9LEVRAYwQbIBR6cb6mmAwRhp1xCUiqf53XqsnVr9S9wrgwoDcVFL9/TxHRcQjpqEN3qrhRHBIlu97hAGBzJyN4gGety8zsW7xZuKaYGmg2zob9ERds51DYGDyzW/GPBEPgLeUKq5Wv5pN9wqzGKOFlxAMfbxOwDEvkOxUfpWAI3lLEjvk/ROdT1oxaTof1EprwxigSRc6s8OJW663RHXrFnxc+dRTIk6+x4eM/CT1OumWD+clikul3RjYB/SzZve+FNP2gg=
deploy:
  provider: npm
  email: jononor@gmail.com
  api_key:
    secure: J/iPIJRvsmhgpx4BPysOZYjE1b9uVfgmfFgXYTG6y7z7SoKEE42iX5ATM1QHezyazqmNbOTETX2J2XR/6RU6JyCNnXEDejxCnN96ZGx+h7xBFvw9IFkB9d91ASKTNZoY+hY1cI08xAfaLqr3Yo/QVLkOKyVmWbBpXkOi+xw/6NDsOQJ3SUqigXkfc2i4GNWM+HHWDgFZUWH9YAvTwKJzo4O5EMgAi/2yT/rwUitxHuNDy8sEm4TgtQWhdOq1Q/20M1KiN7lWJbs2VI6M2gif50VPJYd+R1cvJvq4BIpKghektQX7YpWTildDf4Ovy07G0r6Lwkk5TZDFAzKvP1etCmAinSsBRp8yrUArR/E6p+bfZJg/Ifw/P09gP5mUR30GEeGoCAAmIVxC+M+jHpBPbywQnlc7S/JTWc52sfRDuYsVSrP0aLHGIGZf2pB4nz8vdr2QqZQccV7GV1MW8LjeBfLUVPtjmMBsPNowftriyLaPNBkba3nAd+EGMLHpEfKsiGF9Q0Dq2X7kl6OeGBdvidJySEd/gqgkMRdUJzVa16wHQ6COLmuChgAS1/43liq4PKPNYCfZgd3O0ubPFvuLvhnrCrEsgqn3pSt7+/eATZ0W9YqGhfV5g6JE7Xxly+z67GmRZ3ABfYl6nvHiq10Nl/zYQrvPtQfi1BQ57hWZEIk=
  on:
    tags: true
    repo: flowhub/bigiot-bridge
