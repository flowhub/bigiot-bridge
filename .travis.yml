language: node_js
node_js:
- '8'
dist: trusty
services:
- docker
- redis
before_script:
- cp .env-default .env
- npm run build
- npm run tag
- npm run registry-login
after_success:
- test -n "$TRAVIS_TAG" && npm run deploy
env:
  matrix:
  - NOFLO_FATAL_DEPRECATED=true REDIS_URL=redis://localhost:6379
  global:
  - secure: n6wG54s2+59nkNfD1hBZMoH7qPSyceqCibABfHoANlpNCA0rMVr26oB0RqOHk7R86MHPkCgyoCfgz65pCWKOTakiBXZjoJNov8ij5WPqwBckBtnsDxKGscGuIZ3REwrZHGqxXOYLnkaD72F6OFN0S6AgjVONpqTyZSsIKY1cJdP7d9e4u5xB48edyNE6APF9l3Hl3Gnj07Na3ksdyq5XdxvBOHKK9UDDEsKN5rmWs+eIvUjNIeRK1MAIy87YUvcA1G7HpOAibf7zDtIwO8Pj0QKVnqVEOa0vFWkNOxdltuJzRBpduVJgpMlrH3xKyXBd+C1kJdHMhvAZFm3y6Q3YIkRHtw9M+3sFU5VJlQixufNHuoXau0kBRtRpENlxNJBSLt7QT0jAjXqmEnqpmF2r3PEInp6pfVfwBUHPP2DwIMrgJHKpWEpLpYC7zAD+FmDreZGhQPjDhE7FQGAO5n/0OdpdOS3q72/oxEXNFyOWf75KEm0P/CQ9+Bf0tdB6HHnhg+G2oyvKXc8tFTmImWoNFofTiU7KIlQ+1NQQX//ZB2h0ajAwDt2rpbvpc2mXuzUcHn0WrCMTimJeg8elkNmqdFWd+f0wnXsGptmS30PpCs9xhfp3NqMtkMsDSs/1qQAL1L9cWu7Zosle7/9vts79vgf0TG5uV3AWsImP1gduHLU=
  - secure: Q9b8Zvkyniq34QOZ8k7JRLg5+nL+yOSDvn4/TBoiqXHjGQ56baFV0BAJ9ioiDAAVd8/B65q4IsGsZJ8G91OgehAGDbuzYGi88zpJgREaCYksS9NFUsM0nC9Ukilqqmug0otI36SuxKHOM/lYIAF3hAIt1Y6poYKWDR/II8A2BNXytEya26sZvNT7hzkzUPA3sUaXYmNxZjuUlOKZF/Pg2Cffwa5CTkm/0gzuQh6YtncvIQxWfjgDJe7XxCHqlKonc+I6Lm3WJTvnoZaJLW0uL/2zpdG4FnhdyzOrniCIc4oZIQZ+H7RoPgVE5XNH+mYiuDMMuP2JLouYVdHjxyjYvBWSxDsDNDgKTx717Y64yPgl6TfvMAfT3hvYQ07qu7m7zhfAblFr/UIl1V3oMyERI8vG1FPOIj9SWUgQBqX9r55FDfiZu9sr8KaU35rIPPhqaJXJmwEAN5nO94TH62sV3sNTnX8sJS4IbOyJ9JyxdZyBHJB236gP9BlPyhb6dPW+4Ar0FivmTC4R2cExrlHDVeI8AEKJUUpClAXxjuH2oJ9VaN0iZStT7HVrSrxrUZab5ACJNP7xW4R3RXY8SujsychEeirkXGWwPNSuo8c8DizZP+um6KH5Xeg/PAZ1qk2DlUtR8UMGSfro2cVwrV2jEljYsH7a0VqwJ0mmaCgTYhE=
  - secure: FibE9OgwUY8tYY9pZEKk8oZ7mcOndmpYth2e49ZMWUIU6fsiPQkXt6VM5CndU5n+p66t9Y9Rc+W2JtwifwwYkw1NA/tTGu3UCWyNLAuenWVcd8B4hcSMdwjRkqyecg09sOW1Yi8FpSf6GBFbKW+N84j0RgfkBVz+sLMIThFCa8RGZ8iErd8+VjTuia6NCGDMt1ObEvEWwZB2fjq6/WKhYC8T89HB9kFagSgF8ywGYQ6U6rpT1cRAZM+LaFWuIDIBhAhDQW3jtHvy1a6Qpig/QCl8J14eeoWJzmfUDc6eJaemRiGFB97mk4CqlIKuT4z8IUSPLRPdDgaWI94wtZMjgcnYcNvRwiQAI4brxosFMaGCB/bXSZcLwjLMXmei32slQI2DCgYkPqMPJpVglJC/1zQ75+mGnqhVUg0WMfh2Kq/zl1UZbtM6Y165gpNM+l3yWrFPs+xmJ1/dQaV5U8PZs7vtFJJ7InMs3lgBeaEQFv02BI3JJxSmg47z/0BngDDXfylEWnFLgubdmAwq8mXRSFz6f0BtVGB9yqRkYg918kvKR1pEF3KWyyFlntmP0IRl024ZCy48W9C3Xqpw6BuLNCkaoITf+sSvjLDHjddXKE35GD4LtWVDOP052smRLEbpOojrRrAPMCv15lkJp6OfAsyd7BBtpMT16dMsdLc4/Ss=
  - secure: MVq2PexQiuYqSjHOdTTyDy1IFcBWLqsoecXdDrtCoRgM5g7yDlqBMoRIhRtPzfY6SH2XsI39n/J5znb6yfmRYVr9KuVx4Mm0vf5vDpaQRdhnWUfL9/qlgkPXkllDyt/4hMByQV9J4UMtrMxMSuEXo2giLG26jTsLe1kz1jesqP/3HHOvKJQYxfmsVwRlQcBgvhuaJbIg6UpbV6hLCgQOP1YnWRaV5kadFY4tJTu2CDDaEz//aK001GZiU3dPxuK0Hs+XYcc6+hT+Jhn1DYtbBybi7j9pVOnMYERJ/UPrdhmRFuccFByJHnqqg6UhSWSZOV3Yez7lmPi0XEuR5B1U2oiE994a94xBI1mb8xicRS7YtFRO1RCMFHNySVuI48+t86ZyJz2n9PyDIr0IHtsYU5KFW4ll4wkhJYByCJP2j5HVEgUtQqzFTF8PiTApnLO3XJrOvIGjgvIBh5gzyZUJeeVvQlkfQ1Osf8Xs4e+J6nUBVwQF82XQpsJrXJ1p9KXrUGdjilnErPkMfFNf3AFUGhoVSglNN5kC8X4W+mJzizNhC8UyGvuRUr2nC9ijQPnLTSJkbqXzv4Vqn6FYwFzienUzXLumNn2bUZaPug3DyMgximgmevXz96OnRlXxd9nzRte6wZJ8xT5QKi9nx3yvIqW5Kmrku9mbIj+Ze4+r2WU=
deploy:
  provider: npm
  email: jononor@gmail.com
  api_key:
    secure: J/iPIJRvsmhgpx4BPysOZYjE1b9uVfgmfFgXYTG6y7z7SoKEE42iX5ATM1QHezyazqmNbOTETX2J2XR/6RU6JyCNnXEDejxCnN96ZGx+h7xBFvw9IFkB9d91ASKTNZoY+hY1cI08xAfaLqr3Yo/QVLkOKyVmWbBpXkOi+xw/6NDsOQJ3SUqigXkfc2i4GNWM+HHWDgFZUWH9YAvTwKJzo4O5EMgAi/2yT/rwUitxHuNDy8sEm4TgtQWhdOq1Q/20M1KiN7lWJbs2VI6M2gif50VPJYd+R1cvJvq4BIpKghektQX7YpWTildDf4Ovy07G0r6Lwkk5TZDFAzKvP1etCmAinSsBRp8yrUArR/E6p+bfZJg/Ifw/P09gP5mUR30GEeGoCAAmIVxC+M+jHpBPbywQnlc7S/JTWc52sfRDuYsVSrP0aLHGIGZf2pB4nz8vdr2QqZQccV7GV1MW8LjeBfLUVPtjmMBsPNowftriyLaPNBkba3nAd+EGMLHpEfKsiGF9Q0Dq2X7kl6OeGBdvidJySEd/gqgkMRdUJzVa16wHQ6COLmuChgAS1/43liq4PKPNYCfZgd3O0ubPFvuLvhnrCrEsgqn3pSt7+/eATZ0W9YqGhfV5g6JE7Xxly+z67GmRZ3ABfYl6nvHiq10Nl/zYQrvPtQfi1BQ57hWZEIk=
  on:
    tags: true
    repo: flowhub/bigiot-bridge
